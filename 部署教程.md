# 云端寻踪收款账单管理系统 - 独立部署教程

本教程将指导您将系统部署到 **Railway**（推荐）或其他平台，完全脱离 Manus。

---

## 方案一：Railway 部署（推荐，最简单）

Railway 是一个一站式部署平台，包含服务器和数据库，费用约 $5/月。

### 步骤 1：注册 Railway 账号

1. 访问 https://railway.app
2. 使用 GitHub 账号登录（推荐）或邮箱注册

### 步骤 2：创建数据库

1. 点击 "New Project"
2. 选择 "Provision MySQL"
3. 等待数据库创建完成
4. 点击数据库，在 "Connect" 标签页复制 `DATABASE_URL`

### 步骤 3：上传代码到 GitHub

1. 在 GitHub 创建新仓库（私有）
2. 将本项目代码上传到仓库：
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/你的用户名/仓库名.git
   git push -u origin main
   ```

### 步骤 4：部署应用

1. 在 Railway 点击 "New" → "GitHub Repo"
2. 选择您刚创建的仓库
3. Railway 会自动检测并部署

### 步骤 5：配置环境变量

1. 点击部署的服务
2. 进入 "Variables" 标签页
3. 添加环境变量：
   - `DATABASE_URL`: 从步骤2复制的数据库连接字符串
   - `PORT`: 3000
   - `NODE_ENV`: production

### 步骤 6：初始化数据库

1. 在 Railway 服务中打开 "Shell"
2. 运行：`pnpm db:push`

### 步骤 7：绑定域名

1. 在 "Settings" → "Domains" 中
2. 可以使用 Railway 提供的免费域名
3. 或绑定您自己的域名

---

## 方案二：Vercel + PlanetScale 部署（免费）

### 步骤 1：创建 PlanetScale 数据库

1. 访问 https://planetscale.com 注册账号
2. 创建新数据库，选择免费套餐
3. 在 "Connect" 中选择 "Node.js"，复制连接字符串

### 步骤 2：上传代码到 GitHub

同方案一的步骤3

### 步骤 3：部署到 Vercel

1. 访问 https://vercel.com 使用 GitHub 登录
2. 点击 "Add New Project"
3. 导入您的 GitHub 仓库
4. 在 "Environment Variables" 中添加：
   - `DATABASE_URL`: PlanetScale 连接字符串

### 步骤 4：配置构建命令

在 Vercel 项目设置中：
- Build Command: `pnpm run build`
- Output Directory: `dist/client`
- Install Command: `pnpm install`

---

## 方案三：自有服务器部署

### 服务器要求

- Node.js 18+
- MySQL 8.0+ 或兼容数据库
- 至少 512MB 内存

### 部署步骤

1. 上传代码到服务器
2. 安装依赖：`pnpm install`
3. 创建 `.env` 文件，配置 DATABASE_URL
4. 初始化数据库：`pnpm db:push`
5. 构建项目：`pnpm build`
6. 启动服务：`pnpm start`

### 使用 PM2 保持运行

```bash
npm install -g pm2
pm2 start dist/index.js --name invoice-manager
pm2 save
pm2 startup
```

---

## 修改登录密码

登录密码在前端代码中配置，位置：

`client/src/components/DashboardLayout.tsx`

找到以下代码并修改：
```typescript
const CORRECT_PASSWORD = "Bao12345678..";
```

修改后需要重新构建部署。

---

## 常见问题

### Q: 数据库连接失败？
A: 检查 DATABASE_URL 格式是否正确，确保包含 SSL 参数

### Q: 页面空白？
A: 检查构建是否成功，查看浏览器控制台错误

### Q: 如何备份数据？
A: 在数据库控制台导出 SQL 文件

---

## 技术支持

如有问题，请检查：
1. 环境变量是否正确配置
2. 数据库是否已初始化
3. 构建日志是否有错误

祝您部署顺利！
